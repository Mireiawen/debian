---
## /* vim: set tabstop=2 softtabstop=2 shiftwidth=2 expandtab smarttab autoindent: */

name: "Docker Image CI"

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

env:
  TAG: "buster-$(date --utc '%Y.%m.%d')"

jobs:
  build:
    runs-on: "ubuntu-latest"

    steps:
    - name: "Checkout"
      uses: "actions/checkout@v2"
    - name: "Build the Docker image"
      run: docker build "." --tag "${{TAG}}"
    - name: "Log in to the registry"
      run: docker login --username "${{secrets.DOCKERHUB_USERNAME}}" --password "${{secrets.DOCKERHUB_PASSWORD}}"
    - name: "Push the Docker image"
      run: docker push --tag "${{TAG}}"
